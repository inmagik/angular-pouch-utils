/*!
 * angular-pouch-utils
 * 
 * Version: 0.1.0 - 2014-10-19T23:36:07.095Z
 * License: 
 */
!function(){"use strict";angular.module("pouchUtils",[]).factory("pouchService",["$q",function(r){var e={},t={include_docs:!0,conflicts:!0};return e.getDocListFactory=function(e){return function(n){var c=_.extend(t,n||{}),o=r.defer();return e.allDocs(c,function(r,e){r&&o.reject(r);var t=c.include_docs?_.pluck(e.rows,"doc"):e.rows;o.resolve(t)}),o.promise}},e.wrapQuery=function(e,n,c){var o=_.extend(t,c||{}),u=r.defer();return e.query(n,o,function(r,e){r&&u.reject(r);var t=o.include_docs?_.pluck(e.rows,"doc"):e.rows;u.resolve(t)}),u.promise},e.queryFactory=function(r){return function(t,n){return e.wrapQuery(r,t,n)}},e.filterFactory=function(r){return function(t,n){var c=function(r,e){t(r)&&e(r._id)};return e.wrapQuery(r,{map:c},n)}},e.rejectFactory=function(r){return function(t,n){var c=function(r,e){t(r)||e(r._id)};return e.wrapQuery(r,{map:c},n)}},e.whereFactory=function(r){return function(t,n){var c=_.matches(t),o=function(r,e){c(r)&&e(r._id)};return e.wrapQuery(r,{map:o},n)}},e.whereNotFactory=function(r){return function(t,n){var c=_.matches(t),o=function(r,e){c(r)||e(r._id)};return e.wrapQuery(r,{map:o},n)}},e.getDocFactory=function(e){return function(t,n){var c=r.defer(),o=_.extend({conflicts:!0},n||{});return e.get(t,o,function(r,e){r&&c.reject(r),c.resolve(e)}),c.promise}},e.saveDocFactory=function(e){return function(t){var n=r.defer();return t._id&&t._rev?e.put(t,t._id,t._rev).then(function(r){t._rev=r.rev,n.resolve(t)}).catch(function(r){n.reject(r)}):e.post(t,t._id).then(function(r){t._id=r.id,t._rev=r.rev,n.resolve(t)}).catch(function(r){n.reject(r)}),n.promise}},e.deleteDocFactory=function(e){return function(t,n){var c=r.defer();return e.remove(t,n,function(r,e){r&&c.reject(r),c.resolve(e)}),c.promise}},e.getDBManager=function(r){return{get:e.getDocFactory(r),save:e.saveDocFactory(r),"delete":e.deleteDocFactory(r),all:e.getDocListFactory(r),query:e.queryFactory(r),filter:e.filterFactory(r),reject:e.rejectFactory(r),where:e.whereFactory(r),whereNot:e.whereNotFactory(r)}},e}])}();